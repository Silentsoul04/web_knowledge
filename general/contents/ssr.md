# Server Side Rendering (SSR)
Complete markup is served to the client before executing the client scripts which add interactivity to the app.

## Cause
The rise of Single Page Application(SPA).

* Originally process
  Server return empty HTML(may with text) of each page + css/JS links. If the SPA use old process will have following problems.
  -> user wait longer for initial render.
  -> crawler interpret your page as empty. (under react app)
* Solution
  <strong>SSR</strong> + SPA = Universal App / Isomorphic app
  -> Your webpage will become static page and crawler index all contents you render on the server.

## Advantages
* Better performance for customers.
* Good for SEO. (Crawler of search engine have somethings to look at.)
* No page flickering (ex: image downloading)

note:
* CSR can solve page flickering by sending loading-image at first.

## Explanation

### Better Performance

#### Server Side Rendering Steps (SSR)
1. Server sending fully-ready-beRendered-html-response to Browser
2. Browser render the page (html + css + data generated by partial javascript) and download rest of javascript(react) at same time.
3. Browser executes react.
4. Page now interactable.

note:
* at stage two the website was already viewable to clients.
* Execute react: building virtual dom, attaching events, ReactDom.render('app') start, etc.

#### Client Side Rendering (CSR)
1. Server sending Response to Browser (An empty html with link to script)
2. Browser download Js
3. Browser Execute React. (now you try to fetch data from database.)
4. Page now viewable and interactable.

### Good SEO

#### Concepts
If you do CSR, the google crawler can not index anything that is rendered by ReactDOM.render, because browser/crawler only get empty html with external link to bundle.js(generated by webpack). So browser has to download it later and crawler miss the chance to index it.

But if you do server-side rendering, the React.render can be invoked first. Then you can use react.renderToStaticMarkup/renderToString in server.js to make html mockup string and send it on the initial request. Now the crawler can see the thorough content of your website.

#### How to do this in React
* Use React.renderToStaticMarkup/renderToString to make static markup from react component js.
* Render your components before doing anything asynchronous.
* Test each of your pages with Fetch as Google to ensure that the Googlebot is finding your content.

note:
* Google Crawler see nothing when you use reat-router in CSR.


#### [Fetch As Google](https://support.google.com/webmasters/answer/6066468?hl=en)
Use the Tool provided by [google console](https://www.google.com/webmasters/#?modal_active=none) to check how many contents of your website that crawler see.

## Caveats
* In CSR mode, even though users see the first page they can't interact with it until react is done executing.
* SSR(Time to First Byte) is slower than CSR. (Server need to spend time on creating HTML static page)
* SSR throughput is significantly less than CSR. ReactDOMServer.renderToString is a synchronous CPU bound call, which holds the event loop, which mean the server will not be able to process any other request until ReactDOMServer.renderToString completes.

## Example

### [react-ssr-Alex Moldovan- Github](https://github.com/alexnm/react-ssr)
* server.js provide html template
* app.bundle.js + ReactDOM.hydrate attach event handlers.



[Benefit of using Server Side Rendering - Alex Grigoryan - Medium](https://medium.com/walmartlabs/the-benefits-of-server-side-rendering-over-client-side-rendering-5d07ff2cefe8)

## Terminology
Throughput: homy many units of information a system can process in a given amount of time.

## References

* [React Isomorphic Example - Github](https://github.com/wbkd/react-isomorphic-example)
* [Benefit of using Server Side Rendering - Alex Grigoryan - Medium](https://medium.com/walmartlabs/the-benefits-of-server-side-rendering-over-client-side-rendering-5d07ff2cefe8)
* [Will Google find your react content ? Andrew Farmer](https://www.javascriptstuff.com/react-seo/)
* [React website's SEO using Fetch as Google - Patrick Hund - freeCodeCamp](https://medium.freecodecamp.org/using-fetch-as-google-for-seo-experiments-with-react-driven-websites-914e0fc3ab1)
* [Server-side Rendering in React/Redux Project - Alex Moldovan - freecodeCamp](https://medium.freecodecamp.org/demystifying-reacts-server-side-render-de335d408fe4)


## To Read
[Redux Server-side Rendering](https://redux.js.org/recipes/server-rendering)

Lazy load

[React-Helmet](https://github.com/nfl/react-helmet)
Metadata for SEO
